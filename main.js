!function(){"use strict";class e{constructor(e,t){let{data:s,clickHandler:i,likeHandler:r,deleteHandler:n,userID:o}=e;this._name=s.name,this._link=s.link,this._likes=s.likes,this.id=s._id,this._selectors=t,this._handleCardClick=i,this._handleLikeClick=r,this._handleDeleteClick=n,this._userID=o,this.isLiked=!1}_getTemplate(){return document.querySelector(this._selectors.templateSelector).content.querySelector(this._selectors.cardSelector).cloneNode(!0)}_checkLikes(){this._likes.forEach((e=>{e._id==this._userID&&(this.isLiked=!0)}))}initiateCard(e){this._checkLikes(),this._cardElement=this._getTemplate();const t=this._cardElement.querySelector(this._selectors.titleSelector);return this._image=this._cardElement.querySelector(this._selectors.imageSelector),this._like=this._cardElement.querySelector(this._selectors.likeSelector),this.isLiked&&this._like.classList.add(this._selectors.likeActiveClass),this._likeCount=this._cardElement.querySelector(this._selectors.likeCountSelector),this.setLikeCount(this._likes.length),this._delete=this._cardElement.querySelector(this._selectors.deleteSelector),t.textContent=this._name,this._image.alt="A picture of ".concat(this._name,"."),this._image.src=this._link,e||this._delete.remove(),this._setEventListeners(e),this._cardElement}setLikeCount(e){return this._likeCount.textContent=e}_setEventListeners(e){this._like.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._image.addEventListener("click",(()=>{this._handleCardClick(this._name,this._link)})),e&&this._delete.addEventListener("click",(()=>{this._handleDeleteClick(this)}))}likeCard(){this._like.classList.add(this._selectors.likeActiveClass),this.isLiked=!0}unlikeCard(){this._like.classList.remove(this._selectors.likeActiveClass),this.isLiked=!1}deleteCard(){this._cardElement.remove()}}class t{constructor(e,t){this._formElement=document.querySelector(e),this._keys=t}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._inputList=[...this._formElement.querySelectorAll(this._keys.inputSelector)],this._buttonElement=this._formElement.querySelector(this._keys.submitButtonSelector),this._toggleButtonState(),this._formElement.addEventListener("reset",(()=>{setTimeout((()=>{this._toggleButtonState()}))})),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_showInputError(e,t){const s=this._formElement.querySelector(".popup__error_type_".concat(e.id));e.classList.add(this._keys.inputErrorClass),s.textContent=t,s.classList.add(this._keys.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".popup__error_type_".concat(e.id));e.classList.remove(this._keys.inputErrorClass),t.textContent="",t.classList.remove(this._keys.errorClass)}_toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._keys.inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._keys.inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}}function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class i{constructor(e){s(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),s(this,"_handleClickClose",(e=>{e.target.classList.contains("popup")&&this.close()})),this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".popup__exit-button")}close(){this._popupElement.classList.add("invisible"),document.removeEventListener("keydown",this._handleEscClose)}open(){this._popupElement.classList.remove("invisible"),document.addEventListener("keydown",this._handleEscClose)}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("mousedown",this._handleClickClose)}}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n extends i{constructor(e,t){super(e),r(this,"setInputValues",(e=>{this._inputList.forEach((t=>{t.value=e[t.name]}))})),r(this,"renderLoading",(()=>{this._submitButton.textContent="Saving...",this._submitButton.setAttribute("disabled",!0)})),r(this,"renderError",(e=>{this._submitButton.textContent=e,this._submitButton.classList.add("popup__button_status_error")})),r(this,"renderSuccess",(()=>{this._submitButton.textContent="Saved!",this._submitButton.classList.add("popup__button_status_success")})),r(this,"restoreButtonDefaults",(()=>{this._submitButton.textContent=this._submitButton.name,this._submitButton.classList.remove("popup__button_status_error","popup__button_status_success"),this._submitButton.removeAttribute("disabled")})),this._submitHandler=t,this._formElement=this._popupElement.querySelector(".popup__form"),this._submitButton=this._formElement.querySelector(".popup__button"),this._inputList=this._formElement.querySelectorAll(".popup__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._submitHandler(t)})),super.setEventListeners()}close(){this._formElement.reset(),super.close()}}const o={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},l={templateSelector:"#card-template",likeActiveClass:"gallery__button_active",deleteSelector:".gallery__delete-button",likeSelector:".gallery__button",imageSelector:".gallery__image",titleSelector:".gallery__title",cardSelector:".gallery__cell",likeCountSelector:".gallery__like-count"},a=(document.querySelector("#name"),document.querySelector("#job"),document.querySelector(".profile__edit-button")),c=document.querySelector(".profile__add-button"),u=document.querySelector(".profile__avatar-button"),h=new class{constructor(e,t){this._baseUrl=e,this._headers=t}_checkResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}getUserInfo(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then(this._checkResponse)}getInitialCards(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then(this._checkResponse)}updateUserData(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}updateUserAvatar(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._checkResponse)}addNewCard(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}deleteCard(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"Delete",headers:this._headers}).then(this._checkResponse)}}("https://around.nomoreparties.co/v1/group-12",{authorization:"1ef576b8-6d38-4f6c-aed4-fbb58187f608","Content-Type":"application/json"}),_=new class{constructor(e){let{selectors:t}=e;this._selectors=t,this._userName=document.querySelector(this._selectors.nameSelector),this._userJob=document.querySelector(this._selectors.jobSelector),this._userAvatar=document.querySelector(this._selectors.imageSelector)}getUserInfo(){return{name:this._userName.textContent,about:this._userJob.textContent}}setUserInfo(e){this._userName.textContent=e.name,this._userJob.textContent=e.about,this._userAvatar.src=e.avatar}}({selectors:{nameSelector:".profile__name",jobSelector:".profile__career",imageSelector:".profile__avatar"}}),d=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e,t){const s=this._renderer(e);return t?this._container.prepend(s):this._container.append(s)}}({renderer:t=>{const s=new e({data:t,clickHandler:(e,t)=>{E.open(e,t)},likeHandler:e=>{e.isLiked?h.unlikeCard(e.id).then((t=>{e.unlikeCard(),e.setLikeCount(t.likes.length)})).catch((e=>console.log(e))):h.likeCard(e.id).then((t=>{e.likeCard(),e.setLikeCount(t.likes.length)})).catch((e=>console.log(e)))},deleteHandler:e=>{b.open(e)},userID:_.id},l),i=t.owner._id===_.id;return s.initiateCard(i)}},".gallery__container"),p=new n("#edit-container",(e=>{p.renderLoading(),h.updateUserData(e).then((e=>{p.renderSuccess(),_.setUserInfo(e),setTimeout((()=>p.close()),350)})).catch((e=>{console.log(e),p.renderError(e)})).finally((()=>{setTimeout((()=>p.restoreButtonDefaults()),1500)}))})),m=new n("#add-container",(e=>{m.renderLoading(),h.addNewCard(e).then((e=>{m.renderSuccess(),d.addItem(e,!0),setTimeout((()=>m.close()),350)})).catch((e=>{console.log(e),m.renderError(e)})).finally((()=>{setTimeout((()=>m.restoreButtonDefaults()),1500)}))})),k=new n("#avatar-container",(e=>{k.renderLoading(),h.updateUserAvatar(e).then((e=>{k.renderSuccess(),_.setUserInfo(e),setTimeout((()=>k.close()),350)})).catch((e=>{console.log(e),k.renderError(e)})).finally((()=>{setTimeout((()=>k.restoreButtonDefaults()),1500)}))})),b=new class extends i{constructor(e,t){var s,i;super(e),i=e=>{this._confirmButton.textContent=e,this._confirmButton.classList.add("popup__button_status_error"),this._confirmButton.setAttribute("disabled",!0),setTimeout((()=>{this._confirmButton.textContent=this._confirmButton.name,this._confirmButton.classList.remove("popup__button_status_error"),this._confirmButton.removeAttribute("disabled")}),3e3)},(s="renderError")in this?Object.defineProperty(this,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[s]=i,this._clickHandler=t,this._confirmButton=this._popupElement.querySelector(".popup__button")}setEventListeners(){this._confirmButton.addEventListener("click",(()=>{this._clickHandler()})),super.setEventListeners()}open(e){this.focusedObj=e,super.open()}}("#delete-container",(()=>{h.deleteCard(b.focusedObj.id).then((()=>{b.focusedObj.deleteCard(),b.focusedObj=null,b.close()})).catch((e=>{console.log(e),b.renderError("Failed to delete")}))})),E=new class extends i{constructor(e){super(e)}open(e,t){this._popupImage=this._popupElement.querySelector(".popup__image"),this._popupImageTitle=this._popupElement.querySelector(".popup__image-title"),this._popupImage.src=t,this._popupImage.alt="Image of ".concat(e),this._popupImageTitle.textContent=e,super.open()}}("#image-container");["#edit-bio","#add-image","#edit-avatar"].forEach((e=>{new t(e,o).enableValidation()})),Promise.all([h.getUserInfo(),h.getInitialCards()]).then((e=>{let[t,s]=e;_.setUserInfo(t),_.id=t._id,s.forEach((e=>{d.addItem(e,!1)}))})).catch((e=>{let[t,s]=e;console.log(t),console.log(s)})),p.setEventListeners(),m.setEventListeners(),k.setEventListeners(),b.setEventListeners(),E.setEventListeners(),a.addEventListener("click",(()=>{p.setInputValues(_.getUserInfo()),p.open()})),c.addEventListener("click",(()=>{m.open()})),u.addEventListener("click",(()=>{k.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFTLEtBQ25Dd0gsRUFBUW9CLGVBQWVoRCxFQUFRZixlQUMvQjJDLEVBQVEzRSxVQUdWa0IsRUFBVS9ELGlCQUFpQixTQUFTLEtBQ2xDOEgsRUFBUWpGLFVBR1ZtQixFQUFhaEUsaUJBQWlCLFNBQVMsS0FDckMrSCxFQUFXbEYsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvc2NyaXB0cy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGNsaWNrSGFuZGxlciwgbGlrZUhhbmRsZXIsIGRlbGV0ZUhhbmRsZXIsIHVzZXJJRCB9LCBzZWxlY3RvcnMpIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuaWQgPSBkYXRhLl9pZDtcclxuICAgICAgICB0aGlzLl9zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gY2xpY2tIYW5kbGVyO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGxpa2VIYW5kbGVyO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gZGVsZXRlSGFuZGxlcjtcclxuICAgICAgICB0aGlzLl91c2VySUQgPSB1c2VySUQ7XHJcbiAgICAgICAgdGhpcy5pc0xpa2VkID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcnMudGVtcGxhdGVTZWxlY3RvcikuY29udGVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9ycy5jYXJkU2VsZWN0b3IpLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrTGlrZXMoKSB7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMuZm9yRWFjaCgobGlrZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAobGlrZS5faWQgPT0gdGhpcy5fdXNlcklEKSB0aGlzLmlzTGlrZWQgPSB0cnVlO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgaW5pdGlhdGVDYXJkKGlzVXNlckNhcmQpIHtcclxuICAgICAgICB0aGlzLl9jaGVja0xpa2VzKCk7XHJcbiAgICAgICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIGNvbnN0IHRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcnMudGl0bGVTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9ycy5pbWFnZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9saWtlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcnMubGlrZVNlbGVjdG9yKTtcclxuICAgICAgICBpZiAodGhpcy5pc0xpa2VkKSB7IFxyXG4gICAgICAgICAgICB0aGlzLl9saWtlLmNsYXNzTGlzdC5hZGQodGhpcy5fc2VsZWN0b3JzLmxpa2VBY3RpdmVDbGFzcylcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuX2xpa2VDb3VudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3JzLmxpa2VDb3VudFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLnNldExpa2VDb3VudCh0aGlzLl9saWtlcy5sZW5ndGgpO1xyXG4gICAgICAgIHRoaXMuX2RlbGV0ZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3JzLmRlbGV0ZVNlbGVjdG9yKTtcclxuICAgICAgICB0aXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gYEEgcGljdHVyZSBvZiAke3RoaXMuX25hbWV9LmA7XHJcbiAgICAgICAgdGhpcy5faW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgICAgICBpZiAoIWlzVXNlckNhcmQpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGVsZXRlLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyhpc1VzZXJDYXJkKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0TGlrZUNvdW50KGxpa2VDb3VudCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9saWtlQ291bnQudGV4dENvbnRlbnQgPSBsaWtlQ291bnQ7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKGlzVXNlckNhcmQpIHtcclxuICAgICAgICB0aGlzLl9saWtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMuX2ltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzLl9uYW1lLCB0aGlzLl9saW5rKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIGlmIChpc1VzZXJDYXJkKSB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xyXG4gICAgICAgIH0pfVxyXG4gICAgfVxyXG5cclxuICAgIGxpa2VDYXJkKCkge1xyXG4gICAgICAgIHRoaXMuX2xpa2UuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZWxlY3RvcnMubGlrZUFjdGl2ZUNsYXNzKTtcclxuICAgICAgICB0aGlzLmlzTGlrZWQgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIHVubGlrZUNhcmQoKSB7XHJcbiAgICAgICAgdGhpcy5fbGlrZS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NlbGVjdG9ycy5saWtlQWN0aXZlQ2xhc3MpO1xyXG4gICAgICAgIHRoaXMuaXNMaWtlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICAgICAgLy90aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7IHRoaXMgZG9lc24ndCB3b3JrLy9cclxuICAgICAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gICAgY29uc3RydWN0b3IoZm9ybVNlbGVjdG9yLCB2YWxpZGF0aW9uS2V5cykge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2tleXMgPSB2YWxpZGF0aW9uS2V5cztcclxuICAgIH1cclxuXHJcbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHRoaXMuX2lucHV0TGlzdCA9IFsuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2tleXMuaW5wdXRTZWxlY3RvcildO1xyXG4gICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2tleXMuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpOyBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLnBvcHVwX19lcnJvcl90eXBlXyR7aW5wdXRFbGVtZW50LmlkfWApO1xyXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2tleXMuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fa2V5cy5lcnJvckNsYXNzKTtcclxuICAgIH07XHJcblxyXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC5wb3B1cF9fZXJyb3JfdHlwZV8ke2lucHV0RWxlbWVudC5pZH1gKTtcclxuICAgICAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9rZXlzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICAgICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9rZXlzLmVycm9yQ2xhc3MpOyBcclxuICAgIH1cclxuXHJcbiAgICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dExpc3QpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9rZXlzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9rZXlzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICAgICAgICB0aGlzLl9idXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZXhpdC1idXR0b25cIik7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUNsaWNrQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBcIikpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImludmlzaWJsZVwiKTtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcImludmlzaWJsZVwiKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBzdWJtaXRIYW5kbGVyKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IHN1Ym1pdEhhbmRsZXI7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fZm9ybVwiKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIik7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5wb3B1cF9faW5wdXRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdHMgPSB7fTtcclxuICAgICAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgcmVzdWx0c1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcygpO1xyXG4gICAgICAgICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKGlucHV0cyk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpOyBcclxuICAgIH1cclxuXHJcbiAgICBzZXRJbnB1dFZhbHVlcyA9IChkYXRhKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJMb2FkaW5nID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckVycm9yID0gKGVycm9yKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gZXJyb3I7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9fYnV0dG9uX3N0YXR1c19lcnJvclwiKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJTdWNjZXNzID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZWQhXCI7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9fYnV0dG9uX3N0YXR1c19zdWNjZXNzXCIpXHJcbiAgICB9XHJcblxyXG4gICAgcmVzdG9yZUJ1dHRvbkRlZmF1bHRzID0gKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi5uYW1lO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX2J1dHRvbl9zdGF0dXNfZXJyb3JcIiwgXCJwb3B1cF9fYnV0dG9uX3N0YXR1c19zdWNjZXNzXCIpO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcclxuICAgIH1cclxufSIsImNvbnN0IHZhbGlkYXRpb25PYmogPSB7XHJcbiAgICBpbnB1dFNlbGVjdG9yOiBcIi5wb3B1cF9faW5wdXRcIixcclxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5wb3B1cF9fYnV0dG9uXCIsXHJcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICAgIGlucHV0RXJyb3JDbGFzczogXCJwb3B1cF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gICAgZXJyb3JDbGFzczogXCJwb3B1cF9fZXJyb3JfdmlzaWJsZVwiXHJcbn1cclxuXHJcbmNvbnN0IGNhcmRTZWxlY3Rvckxpc3QgPSB7XHJcbiAgdGVtcGxhdGVTZWxlY3RvcjogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gIGxpa2VBY3RpdmVDbGFzczogXCJnYWxsZXJ5X19idXR0b25fYWN0aXZlXCIsXHJcbiAgZGVsZXRlU2VsZWN0b3I6IFwiLmdhbGxlcnlfX2RlbGV0ZS1idXR0b25cIixcclxuICBsaWtlU2VsZWN0b3I6IFwiLmdhbGxlcnlfX2J1dHRvblwiLFxyXG4gIGltYWdlU2VsZWN0b3I6IFwiLmdhbGxlcnlfX2ltYWdlXCIsXHJcbiAgdGl0bGVTZWxlY3RvcjogXCIuZ2FsbGVyeV9fdGl0bGVcIixcclxuICBjYXJkU2VsZWN0b3I6IFwiLmdhbGxlcnlfX2NlbGxcIixcclxuICBsaWtlQ291bnRTZWxlY3RvcjogXCIuZ2FsbGVyeV9fbGlrZS1jb3VudFwiXHJcbn1cclxuXHJcbmNvbnN0IGlucHV0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZVwiKTtcclxuY29uc3QgaW5wdXRKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2pvYlwiKTtcclxuY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xyXG5jb25zdCBmb3JtU2VsZWN0b3JzID0gW1wiI2VkaXQtYmlvXCIsIFwiI2FkZC1pbWFnZVwiLCBcIiNlZGl0LWF2YXRhclwiXTtcclxuY29uc3QgdXNlclNlbGVjdG9ycyA9IHtuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX25hbWVcIiwgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2NhcmVlclwiLCBpbWFnZVNlbGVjdG9yOiBcIi5wcm9maWxlX19hdmF0YXJcIn07XHJcblxyXG5cclxuZXhwb3J0IHsgdmFsaWRhdGlvbk9iaiwgY2FyZFNlbGVjdG9yTGlzdCwgaW5wdXROYW1lLCBpbnB1dEpvYiwgZWRpdEJ1dHRvbiwgYWRkQnV0dG9uLCBmb3JtU2VsZWN0b3JzLCB1c2VyU2VsZWN0b3JzLCBhdmF0YXJCdXR0b24gfSIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9BcGkuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vc2NyaXB0cy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL3NjcmlwdHMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9zY3JpcHRzL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IHsgdmFsaWRhdGlvbk9iaiwgY2FyZFNlbGVjdG9yTGlzdCwgaW5wdXROYW1lLCBcclxuICBpbnB1dEpvYiwgZWRpdEJ1dHRvbiwgYWRkQnV0dG9uLCBmb3JtU2VsZWN0b3JzLCB1c2VyU2VsZWN0b3JzLCBhdmF0YXJCdXR0b24gfSBmcm9tIFwiLi4vc2NyaXB0cy91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbi8vSGVyZSB0byBsaW5lIDEyMDogaW5pdGlhdGluZyBjbGFzc2VzXHJcblxyXG5jb25zdCBwcm9qZWN0QXBpID0gbmV3IEFwaShcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIiwgXHJcbnsgYXV0aG9yaXphdGlvbjogXCIxZWY1NzZiOC02ZDM4LTRmNmMtYWVkNC1mYmI1ODE4N2Y2MDhcIiwgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSk7XHJcblxyXG5jb25zdCB1c2VyQmlvID0gbmV3IFVzZXJJbmZvKHsgc2VsZWN0b3JzOiB1c2VyU2VsZWN0b3JzIH0pO1xyXG5cclxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XHJcbiAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xyXG4gIGNvbnN0IGNhcmRJdGVtID0gbmV3IENhcmQoeyBkYXRhOiBjYXJkRGF0YSwgXHJcbiAgY2xpY2tIYW5kbGVyOiAodGl0bGUsIGxpbmspID0+IHtwb3B1cEltYWdlLm9wZW4odGl0bGUsIGxpbmspfSwgXHJcbiAgbGlrZUhhbmRsZXI6IChvYmopID0+IHtcclxuICAgIGlmICghb2JqLmlzTGlrZWQpIHtcclxuICAgICAgcHJvamVjdEFwaS5saWtlQ2FyZChvYmouaWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBvYmoubGlrZUNhcmQoKTtcclxuICAgICAgICBvYmouc2V0TGlrZUNvdW50KHJlcy5saWtlcy5sZW5ndGgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHByb2plY3RBcGkudW5saWtlQ2FyZChvYmouaWQpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBvYmoudW5saWtlQ2FyZCgpO1xyXG4gICAgICAgIG9iai5zZXRMaWtlQ291bnQocmVzLmxpa2VzLmxlbmd0aCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSl9XHJcbiAgICB9LCBcclxuICBkZWxldGVIYW5kbGVyOiAob2JqKSA9PiB7XHJcbiAgICBkZWxldGVDb25maXJtYXRvbi5vcGVuKG9iaik7XHJcbiAgfSwgXHJcbiAgdXNlcklEOiB1c2VyQmlvLmlkfSwgXHJcbiAgY2FyZFNlbGVjdG9yTGlzdCk7XHJcbiAgY29uc3QgaXNVc2VyQ2FyZCA9IGNhcmREYXRhLm93bmVyLl9pZCA9PT0gdXNlckJpby5pZDtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRJdGVtLmluaXRpYXRlQ2FyZChpc1VzZXJDYXJkKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxufSwgXCIuZ2FsbGVyeV9fY29udGFpbmVyXCIpO1xyXG5cclxuY29uc3QgYmlvRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI2VkaXQtY29udGFpbmVyXCIsIChkYXRhKSA9PiB7XHJcbiAgYmlvRm9ybS5yZW5kZXJMb2FkaW5nKCk7XHJcbiAgcHJvamVjdEFwaS51cGRhdGVVc2VyRGF0YShkYXRhKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGJpb0Zvcm0ucmVuZGVyU3VjY2VzcygpO1xyXG4gICAgdXNlckJpby5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiBiaW9Gb3JtLmNsb3NlKCksIDM1MCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIGJpb0Zvcm0ucmVuZGVyRXJyb3IoZXJyKTtcclxuICB9KVxyXG4gIC5maW5hbGx5KCgpID0+IHtcclxuICAgIHNldFRpbWVvdXQoKCkgPT4gYmlvRm9ybS5yZXN0b3JlQnV0dG9uRGVmYXVsdHMoKSwgMTUwMCk7XHJcbiAgfSlcclxufSk7XHJcblxyXG5jb25zdCBhZGRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNvbnRhaW5lclwiLCAoZGF0YSkgPT4ge1xyXG4gIGFkZEZvcm0ucmVuZGVyTG9hZGluZygpO1xyXG4gIHByb2plY3RBcGkuYWRkTmV3Q2FyZChkYXRhKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIGFkZEZvcm0ucmVuZGVyU3VjY2VzcygpO1xyXG4gICAgY2FyZFNlY3Rpb24uYWRkSXRlbShyZXMsIHRydWUpO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiBhZGRGb3JtLmNsb3NlKCksIDM1MCk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIGFkZEZvcm0ucmVuZGVyRXJyb3IoZXJyKTtcclxuICB9KVxyXG4gIC5maW5hbGx5KCgpID0+IHtcclxuICAgIHNldFRpbWVvdXQoKCkgPT4gYWRkRm9ybS5yZXN0b3JlQnV0dG9uRGVmYXVsdHMoKSwgMTUwMCk7XHJcbiAgfSlcclxufSlcclxuXHJcbmNvbnN0IGF2YXRhckZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmF0YXItY29udGFpbmVyXCIsIChkYXRhKSA9PiB7XHJcbiAgYXZhdGFyRm9ybS5yZW5kZXJMb2FkaW5nKCk7XHJcbiAgcHJvamVjdEFwaS51cGRhdGVVc2VyQXZhdGFyKGRhdGEpXHJcbiAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgYXZhdGFyRm9ybS5yZW5kZXJTdWNjZXNzKCk7XHJcbiAgICB1c2VyQmlvLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IGF2YXRhckZvcm0uY2xvc2UoKSwgMzUwKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgYXZhdGFyRm9ybS5yZW5kZXJFcnJvcihlcnIpO1xyXG4gIH0pXHJcbiAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiBhdmF0YXJGb3JtLnJlc3RvcmVCdXR0b25EZWZhdWx0cygpLCAxNTAwKTtcclxuICB9KVxyXG59KVxyXG5cclxuY29uc3QgZGVsZXRlQ29uZmlybWF0b24gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2RlbGV0ZS1jb250YWluZXJcIiwgKCkgPT4ge1xyXG4gIHByb2plY3RBcGkuZGVsZXRlQ2FyZChkZWxldGVDb25maXJtYXRvbi5mb2N1c2VkT2JqLmlkKVxyXG4gIC50aGVuKCgpID0+IHtcclxuICAgIGRlbGV0ZUNvbmZpcm1hdG9uLmZvY3VzZWRPYmouZGVsZXRlQ2FyZCgpO1xyXG4gICAgZGVsZXRlQ29uZmlybWF0b24uZm9jdXNlZE9iaiA9IG51bGw7XHJcbiAgICBkZWxldGVDb25maXJtYXRvbi5jbG9zZSgpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICBkZWxldGVDb25maXJtYXRvbi5yZW5kZXJFcnJvcihcIkZhaWxlZCB0byBkZWxldGVcIik7XHJcbiAgfSlcclxufSlcclxuXHJcbmNvbnN0IHBvcHVwSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtY29udGFpbmVyXCIpO1xyXG5cclxuZm9ybVNlbGVjdG9ycy5mb3JFYWNoKChzZWxlY3RvcikgPT4ge1xyXG4gIGNvbnN0IHZhbGlkYXRlZEZvcm0gPSBuZXcgRm9ybVZhbGlkYXRvcihzZWxlY3RvciwgdmFsaWRhdGlvbk9iaik7XHJcbiAgdmFsaWRhdGVkRm9ybS5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG4vL0Fsc28sIHNvcnJ5IGlmIEkgd2Fzbid0IGFsbG93ZWQgdG8gYWRkIGFsbCB0aGVzZSBleHRyYSBVWCBjaGFuZ2VzLCBqdXN0IHRob3VnaHQgaXQgbG9va2VkIG5pY2UgYW5kIHdhcyBhIGdvb2Qgd2F5IHRvIGNvbW11bmljYXRlIHN1Y2Nlc3MvZmFpbHVyZVxyXG5cclxuLy9oZXJlIHRvIGxpbmUgMTQ1OiBjYWxsaW5nIG1ldGhvZHNcclxuUHJvbWlzZS5hbGwoW3Byb2plY3RBcGkuZ2V0VXNlckluZm8oKSwgcHJvamVjdEFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICB1c2VyQmlvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuICAgIHVzZXJCaW8uaWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oaXRlbSwgZmFsc2UpO1xyXG4gICAgfSlcclxuICB9KVxyXG4gIC5jYXRjaCgoW3VzZXJFcnIsIGNhcmRzRXJyXSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2codXNlckVycik7XHJcbiAgICBjb25zb2xlLmxvZyhjYXJkc0Vycik7XHJcbiAgfSk7XHJcblxyXG5iaW9Gb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5hZGRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5hdmF0YXJGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5kZWxldGVDb25maXJtYXRvbi5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxucG9wdXBJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy9oZXJlIHRvIGVuZDogYWRkaW5nIGV2ZW50IGxpc3RlbmVyc1xyXG5lZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYmlvRm9ybS5zZXRJbnB1dFZhbHVlcyh1c2VyQmlvLmdldFVzZXJJbmZvKCkpO1xyXG4gIGJpb0Zvcm0ub3BlbigpO1xyXG59KTtcclxuXHJcbmFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZEZvcm0ub3BlbigpO1xyXG59KVxyXG5cclxuYXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyRm9ybS5vcGVuKCk7XHJcbn0pXHJcblxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoYmFzZVVybCwgaGVhZGVycykge1xyXG4gICAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgICAgIGlmIChyZXMub2spIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlVXNlckRhdGEoZGF0YSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0OiBkYXRhLmFib3V0XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKSAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVVc2VyQXZhdGFyKGRhdGEpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhclxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSkgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgYWRkTmV3Q2FyZChkYXRhKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXHJcbiAgICAgICAgICAgICAgICBsaW5rOiBkYXRhLmxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZChjYXJkSUQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpXHJcbiAgICB9XHJcblxyXG4gICAgbGlrZUNhcmQoY2FyZElEKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElEfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgfVxyXG5cclxuICAgIHVubGlrZUNhcmQoY2FyZElEKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElEfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIkRlbGV0ZVwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoeyBzZWxlY3RvcnMgfSkge1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IHNlbGVjdG9ycztcclxuICAgICAgICB0aGlzLl91c2VyTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3JzLm5hbWVTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fdXNlckpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2VsZWN0b3JzLmpvYlNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl91c2VyQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcnMuaW1hZ2VTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtuYW1lOiB0aGlzLl91c2VyTmFtZS50ZXh0Q29udGVudCwgYWJvdXQ6IHRoaXMuX3VzZXJKb2IudGV4dENvbnRlbnR9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0VXNlckluZm8oZGF0YSkge1xyXG4gICAgICAgIHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICAgIHRoaXMuX3VzZXJKb2IudGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gZGF0YS5hdmF0YXI7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oaXRlbSwgaXNOZXcpIHtcclxuICAgICAgICBjb25zdCBjYXJkID0gdGhpcy5fcmVuZGVyZXIoaXRlbSlcclxuICAgICAgICBpZiAoaXNOZXcpIHJldHVybiB0aGlzLl9jb250YWluZXIucHJlcGVuZChjYXJkKTsgLy9ubyBtb3JlIHNjcm9sbGluZyB0byB0aGUgYm90dG9tIHRvIHNlZSBpZiBteSBjYXJkIHNhdmVkL2RlbGV0ZWQvc3RheWVkIGxpa2VkXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoY2FyZCk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGNsaWNrSGFuZGxlcikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2NsaWNrSGFuZGxlciA9IGNsaWNrSGFuZGxlcjtcclxuICAgICAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2J1dHRvblwiKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fY2xpY2tIYW5kbGVyKCk7XHJcbiAgICAgICAgfSApXHJcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJFcnJvciA9IChtZXNzYWdlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IG1lc3NhZ2U7XHJcbiAgICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwicG9wdXBfX2J1dHRvbl9zdGF0dXNfZXJyb3JcIik7XHJcbiAgICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX2NvbmZpcm1CdXR0b24ubmFtZTtcclxuICAgICAgICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfX2J1dHRvbl9zdGF0dXNfZXJyb3JcIik7XHJcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpcm1CdXR0b24ucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgfSwgMzAwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihvYmopIHtcclxuICAgICAgICB0aGlzLmZvY3VzZWRPYmogPSBvYmo7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKHRpdGxlLCBsaW5rKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19pbWFnZVwiKTtcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlVGl0bGUgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2UtdGl0bGVcIik7XHJcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gYEltYWdlIG9mICR7dGl0bGV9YDtcclxuICAgICAgICB0aGlzLl9wb3B1cEltYWdlVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcbn0iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwic2VsZWN0b3JzIiwiZGF0YSIsImNsaWNrSGFuZGxlciIsImxpa2VIYW5kbGVyIiwiZGVsZXRlSGFuZGxlciIsInVzZXJJRCIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfbGlrZXMiLCJsaWtlcyIsImlkIiwiX2lkIiwiX3NlbGVjdG9ycyIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX3VzZXJJRCIsImlzTGlrZWQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiY29udGVudCIsImNhcmRTZWxlY3RvciIsImNsb25lTm9kZSIsIl9jaGVja0xpa2VzIiwiZm9yRWFjaCIsImxpa2UiLCJpbml0aWF0ZUNhcmQiLCJpc1VzZXJDYXJkIiwiX2NhcmRFbGVtZW50IiwidGl0bGUiLCJ0aXRsZVNlbGVjdG9yIiwiX2ltYWdlIiwiaW1hZ2VTZWxlY3RvciIsIl9saWtlIiwibGlrZVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwiYWRkIiwibGlrZUFjdGl2ZUNsYXNzIiwiX2xpa2VDb3VudCIsImxpa2VDb3VudFNlbGVjdG9yIiwic2V0TGlrZUNvdW50IiwibGVuZ3RoIiwiX2RlbGV0ZSIsImRlbGV0ZVNlbGVjdG9yIiwidGV4dENvbnRlbnQiLCJhbHQiLCJzcmMiLCJyZW1vdmUiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJsaWtlQ291bnQiLCJhZGRFdmVudExpc3RlbmVyIiwibGlrZUNhcmQiLCJ1bmxpa2VDYXJkIiwiZGVsZXRlQ2FyZCIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtU2VsZWN0b3IiLCJ2YWxpZGF0aW9uS2V5cyIsIl9mb3JtRWxlbWVudCIsIl9rZXlzIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiX2lucHV0TGlzdCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl90b2dnbGVCdXR0b25TdGF0ZSIsInNldFRpbWVvdXQiLCJpbnB1dEVsZW1lbnQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9oYXNJbnZhbGlkSW5wdXQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwic29tZSIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImtleSIsImNsb3NlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVFc2NDbG9zZSIsIm9wZW4iLCJzZXRFdmVudExpc3RlbmVycyIsIl9oYW5kbGVDbGlja0Nsb3NlIiwiUG9wdXBXaXRoRm9ybSIsInN1Ym1pdEhhbmRsZXIiLCJzdXBlciIsImlucHV0IiwidmFsdWUiLCJfc3VibWl0QnV0dG9uIiwiZXJyb3IiLCJfc3VibWl0SGFuZGxlciIsIl9nZXRJbnB1dFZhbHVlcyIsInJlc3VsdHMiLCJpbnB1dHMiLCJyZXNldCIsInZhbGlkYXRpb25PYmoiLCJjYXJkU2VsZWN0b3JMaXN0IiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsImF2YXRhckJ1dHRvbiIsInByb2plY3RBcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRVc2VySW5mbyIsImZldGNoIiwidGhlbiIsImdldEluaXRpYWxDYXJkcyIsInVwZGF0ZVVzZXJEYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsInVwZGF0ZVVzZXJBdmF0YXIiLCJhdmF0YXIiLCJhZGROZXdDYXJkIiwiY2FyZElEIiwiYXV0aG9yaXphdGlvbiIsInVzZXJCaW8iLCJfdXNlck5hbWUiLCJuYW1lU2VsZWN0b3IiLCJfdXNlckpvYiIsImpvYlNlbGVjdG9yIiwiX3VzZXJBdmF0YXIiLCJzZXRVc2VySW5mbyIsImNhcmRTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiaXRlbSIsImlzTmV3IiwiY2FyZCIsInByZXBlbmQiLCJhcHBlbmQiLCJjYXJkRGF0YSIsImNhcmRJdGVtIiwicG9wdXBJbWFnZSIsIm9iaiIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImRlbGV0ZUNvbmZpcm1hdG9uIiwib3duZXIiLCJiaW9Gb3JtIiwicmVuZGVyTG9hZGluZyIsInJlbmRlclN1Y2Nlc3MiLCJyZW5kZXJFcnJvciIsImZpbmFsbHkiLCJyZXN0b3JlQnV0dG9uRGVmYXVsdHMiLCJhZGRGb3JtIiwiYXZhdGFyRm9ybSIsIm1lc3NhZ2UiLCJfY29uZmlybUJ1dHRvbiIsIl9jbGlja0hhbmRsZXIiLCJmb2N1c2VkT2JqIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBJbWFnZVRpdGxlIiwic2VsZWN0b3IiLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwidXNlckVyciIsImNhcmRzRXJyIiwic2V0SW5wdXRWYWx1ZXMiXSwic291cmNlUm9vdCI6IiJ9